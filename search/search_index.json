{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Overview","text":""},{"location":"#overview-of-the-workflow","title":"Overview of the workflow","text":"<p>This next-generation sequencing (NGS) pipeline is containerized, platform-independent, uses Nextflow DSL2 workflow, and currently operates on NIH's Biowulf HPC cluster and the AWS cloud. This Exome-RNAseq workflow performs extensive quality control, mutational calling, tumor mutational burden assessment, mutational signatures, HLA typing, copy number calling, T-cell infiltration prediction, neoantigen prediction, gene expression profiling, fusion detection, variant calling, and annotation. This comprehensive suite is crucial for deep genomic characterization, addressing both research samples and clinical patient data at NIH. The ClinOmics data portal extends these capabilities by offering a user-friendly web portal for data exploration.</p> <p>Here is a Snapshot of our RNAseq and Exome workflows.</p>"},{"location":"#rnaseq-workflow","title":"RNAseq Workflow","text":""},{"location":"#exome-workflow","title":"Exome Workflow","text":""},{"location":"#prerequisites","title":"Prerequisites","text":"<p>To run this workflow, you will need the following software: <pre><code>    Nextflow &gt;= 21.04.3\n    Singularity 3.10.5\n    Graphviz 2.40\n</code></pre></p>"},{"location":"#installation","title":"Installation","text":"<p>Please clone this repository to your local filesystem using the following command:</p> <pre><code>        git clone https://github.com/CCRGeneticsBranch/Oncogenomics_NF_WF.git\n        cd Oncogenomics_NF_WF \n</code></pre>"},{"location":"#setting-up-the-workflow-on-biowulf","title":"Setting up the workflow on biowulf","text":"<ol> <li>This workflow is hosted on biowulf in khanlab space /data/khanlab/projects/Nextflow_dev/dev/AWS_POC_Nextflow.</li> <li>All the pipeline config can be accessed using nextflow.config file.</li> <li>Within the nextflow.config file you can select the profile to launch the pipeline. To run pipeline on biowulf select profile <code>biowulf</code>. This is set up to work with biowulf batch resources.</li> <li>Guidelines to create an input samplesheet can be found here.</li> <li>All the references, annotation and bed files are currently located under /data/khanlab. We currently support data processing for these capture kits.</li> </ol>"},{"location":"#sequencing-capture-kits","title":"Sequencing capture kits","text":"RNAseq Exome Access clin_ex_v1 PolyA seqcapez.hu.ex.v3 PolyA_stranded Agilent_v7 Ribozero idt_v2_plus smartrna xgen_hyb_panelv2 <p>If you want to process the data sequenced by other kits, please reach out to Vineela Gangalapudi.</p>"},{"location":"pipeline_launch/","title":"Running the workflow.","text":"<p>The workflow can be started by executing the <code>launch.sh</code> script in a interactive node. This wrapper script spawns new jobs and submits them to the SLURM scheduling system.</p> <pre><code>       sh launch.sh tag /path/to/samplesheet\n       This script takes two inputs\n       Provide Tag argument - This will add a tag to your resultsdir.\n       Provide samplesheet with complete path\n       example: sh launch.sh projectname /path/to/samplesheet  #this will create work.projectname and results.projectname folders under `OUTDIR` path.\n</code></pre>"},{"location":"pipeline_launch/#case1","title":"Case1:","text":"<p>Test samplesheet with subsamples is available here <code>/data/khanlab/projects/Nextflow_dev/testing/exome-rnaseq_samplesheet.csv</code></p>"},{"location":"pipeline_launch/#case2","title":"Case2:","text":"<p>Test samplesheet with 20 samples is available here <code>/data/khanlab/projects/Nextflow_dev/testing/20_samplesheet.csv</code></p> <p>To ensure you dont run into permission issues please run the #Case1 before launching full samples with #Case2</p> <p>The following command should kick initiate the pipeline and display the status.</p> <p><code>sh launch.sh vg0416 /data/khanlab/projects/Nextflow_dev/testing/exome-rnaseq_samplesheet.csv</code> or <code>sbatch --mem=50g --time=24:00:00 sh launch vg0416 /data/khanlab/projects/Nextflow_dev/testing/exome-rnaseq_samplesheet.csv</code></p>"},{"location":"pipeline_launch/#workflow-log","title":"Workflow log","text":"<p>When the workflow is launched, it will produce a log that provides information about the pipeline execution, including the command line used, the version of Nextflow, the input folder path, the results directory, and the work directory.</p> <pre><code>[gangalapudiv2@cn4305 AWS_POC_Nextflow]$ ./launch.sh vg0416\n[+] Loading singularity  3.10.5  on cn4305\n[+] Loading java 17.0.3.1  ...\n[+] Loading nextflow  23.04.1\n[+] Loading Graphviz v 2.46.1  ...\nNXF_HOME=/data/khanlab2/NF_benchmarking/results.vg0416/.nextflow\nnextflow run -c /vf/users/khanlab/projects/Nextflow_dev/AWS_POC_Nextflow/nextflow.config -profile biowulf_test_run_slurm\n/vf/users/khanlab/projects/Nextflow_dev/AWS_POC_Nextflow/main.nf -resume -with-trace -with-timeline\nN E X T F L O W  ~  version 23.04.1\nLaunching `/vf/users/khanlab/projects/Nextflow_dev/AWS_POC_Nextflow/main.nf` [gigantic_moriondo] DSL2 - revision: 47347c03a7\nR N A S E Q - N F   P I P E L I N E\n===================================\nNF version   : 23.04.1\nrunName      : gigantic_moriondo\nusername     : gangalapudiv2\nconfigs      : [/vf/users/khanlab/projects/Nextflow_dev/AWS_POC_Nextflow/nextflow.config,\n/vf/users/khanlab/projects/Nextflow_dev/AWS_POC_Nextflow/nextflow.config]\nprofile      : biowulf_test_run_slurm\ncmd line     : nextflow run -c /vf/users/khanlab/projects/Nextflow_dev/AWS_POC_Nextflow/nextflow.config -profile biowulf_test_run_slurm\n/vf/users/khanlab/projects/Nextflow_dev/AWS_POC_Nextflow/main.nf -resume -with-trace -with-timeline\nstart time   : 2023-07-14T08:38:30.805092321-04:00\nprojectDir   : /vf/users/khanlab/projects/Nextflow_dev/AWS_POC_Nextflow\nlaunchDir    : /gpfs/gsfs10/users/khanlab2/NF_benchmarking/results.vg0416\nworkdDir     : /data/khanlab2/NF_benchmarking/work.vg0416\nhomeDir      : /home/gangalapudiv2\n[bc/d5f459] process &gt; RNAseq_multiple_libs:Common_RNAseq_WF:Cutadapt (Test1c_R_T)                           [100%] 2 of 2, cached: 2 \u2714\n[19/393899] process &gt; RNAseq_multiple_libs:Common_RNAseq_WF:Kraken (Test1_R_T)                              [100%] 2 of 2, cached: 2 \u2714\n[a8/5dba33] process &gt; RNAseq_multiple_libs:Common_RNAseq_WF:Krona (Test1c_R_T)                              [100%] 2 of 2, cached: 2 \u2714\n[a1/839bd7] process &gt; RNAseq_multiple_libs:Common_RNAseq_WF:Fastqc (Test1c_R_T)                             [100%] 2 of 2, cached: 2 \u2714\n[6b/05eb55] process &gt; RNAseq_multiple_libs:Common_RNAseq_WF:Star_RSEM:Star (Test1_R_T)                      [100%] 2 of 2, cached: 2 \u2714\n[ad/fe60ba] process &gt; RNAseq_multiple_libs:Common_RNAseq_WF:Star_RSEM:Strandedness (Test1_R_T)              [100%] 2 of 2, cached: 2 \u2714\n[d5/1866a1] process &gt; RNAseq_multiple_libs:Common_RNAseq_WF:Star_RSEM:Rsem (Test1_R_T)                      [100%] 2 of 2, cached: 2 \u2714\n[70/0bb5d2] process &gt; RNAseq_multiple_libs:Common_RNAseq_WF:Fusion_calling:Arriba (Test1c_R_T)              [100%] 2 of 2, cached: 2 \u2714\n</code></pre>"},{"location":"pipeline_launch/#workflow-resources","title":"Workflow Resources","text":"<p>$Script_home ---&gt; data/khanlab/projects/Nextflow_dev/AWS_POC_Nextflow $Script_home/nextflow.config ---&gt; All the pipeline config resources are called from this file. We are using <code>biowulf_test_run_slurm</code> profile to run the samples on biowulf. $Script_home/config ---&gt; Cluster config, singularity config, docker config and params config are located here</p>"},{"location":"samplesheet/","title":"Setting up Samplesheet","text":"<p>There are two ways to generate a samplesheet for the pipeline depending on the use case. If the goal is to process patient fastq files through the pipeline to use the results for secondary analysis, you can follow these steps to build your own samplesheet. Along with processing the data, if you want to visualize the results on ClinOmics data portal then follow steps to build samplesheet from mastersheet. This is highly recommended.</p>"},{"location":"samplesheet/#build-your-own-samplesheet","title":"Build your own samplesheet","text":"<p>The pipeline requires a CSV file as input for each patient. The samplesheet must include the following mandatory columns:</p> Column name Notes Example sample Patient name NCI-Test1 library Name of the sample library Test1_T1D_E read1 Full path to the read1 /data/khanlab/DATA/Sample_Test1_T1D_E/Sample_Test1_T1D_E.R1.fastq.gz read2 Full path to the read2 /data/khanlab/DATA/Sample_Test1_T1D_E/Sample_Test1_T1D_E.R1.fastq.gz sample_captures Name of the capture kit used List of supported capture kits are here Matched_RNA Matched RNA library for the tumor library Test1_T1R_T Matched_normal Matched exome normal library for the tumor library Test1_N1D_E Diagnosis Diagnosis of the patient Glioma casename Casename for the patient NCI-Test1 type Data type example: tumor_RNA, tumor_DNA, normal_DNA, blood_DNA FCID Flowcell ID ACJ678349"},{"location":"samplesheet/#build-samplesheet-from-mastersheet","title":"Build samplesheet from mastersheet","text":""}]}